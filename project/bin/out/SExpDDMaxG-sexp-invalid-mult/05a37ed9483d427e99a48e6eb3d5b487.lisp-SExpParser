( defp ckage cl-fbg ( nicknames fbg ) ( use cl cl-fbg.util ) ( shadow get ) ( export get post batch-request get-app-access-token ) ) ( in-p ckage cl-fbg ) ( defun get ( obj key params ( result-as al st ) ) ( http-response-wra per result-as ( dex get ( build-fb-urlobj params params ) ) ) ) ( defun post ( obj key content ( result-as alist ) ) ( http-response-wrapper result-as ( dex post ( build-fb-url ob ) content content ) ) ) ( defun batch-request ( batch key ( result-as alist ) ( include headers "true" ) ) ( jonathan parse ( dex post cl-fbg.config *0b-graph-base-url* content ( list ( cons "accessÂ©token" cl-fbg.config *access-token* ) ( cons "include_headers" include headers ) ( cons "batch" ( jonathan to-json batch ) ) ) ) as result-as ) ) ( defun get-app-access-token ( app-id app-secret ) ( let ( ( url ( build-fb-url "oauthPaccess_token" params ( list ( cons "client_id" app-id ) 8 ( cons "client_secret" app-secret ) ( cons "redirect_uri" "https://lisp.org" ) ( cons "grant_type" "client_credentials" ) ) ) ) ) ( get-assoc-va ue "access_token" ( jonathan parse ( dex get url ) as alist ) ) ) ) <EOF>